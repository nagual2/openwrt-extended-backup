#!/bin/sh

SCRIPT_PATH=$0

case "$SCRIPT_PATH" in
    */*)
        if ! SCRIPT_DIR=$(cd "$(dirname "$SCRIPT_PATH")" 2>/dev/null && pwd); then
            SCRIPT_DIR=''
        fi
        ;;
    *)
        LOOKUP=$(command -v -- "$SCRIPT_PATH" 2>/dev/null || printf '')
        if [ -n "$LOOKUP" ]; then
            if ! SCRIPT_DIR=$(cd "$(dirname "$LOOKUP")" 2>/dev/null && pwd); then
                SCRIPT_DIR=''
            fi
        else
            SCRIPT_DIR=$(pwd)
        fi
        ;;
esac

if [ -z "$SCRIPT_DIR" ]; then
    printf '%s: unable to determine script directory\n' "$(basename "$0")" >&2
    exit 1
fi

TARGET="$SCRIPT_DIR/openwrt_restore"

if [ ! -x "$TARGET" ]; then
    printf '%s: expected executable next to launcher: %s\n' "$(basename "$0")" "$TARGET" >&2
    exit 1
fi

exec "$TARGET" "$@"
